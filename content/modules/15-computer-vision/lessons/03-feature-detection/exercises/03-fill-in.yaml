type: fill-in
id: "03-feature-detection-fill-in-01"
prompt: "Fill in the blanks to complete this template matching function using sum of squared differences."
template: |
  import numpy as np

  def template_match(image, template):
      h, w = image.shape
      th, tw = template.____
      results = []
      for i in range(h - th + ____):
          for j in range(w - tw + 1):
              region = image[i:i+th, j:j+tw]
              ssd = np.____(( region - template) ** 2)
              results.append((i, j, ssd))
      return min(results, key=lambda x: x[2])

  img = np.eye(4) * 255
  tmpl = np.eye(2) * 255
  pos = template_match(img, tmpl)
  print(f"Match at ({pos[0]}, {pos[1]}), SSD={pos[2]:.0f}")
blanks:
  - position: 0
    answer: "shape"
    hint: "attribute that gives array dimensions"
  - position: 1
    answer: "1"
    hint: "adjust range so the template fits within the image"
  - position: 2
    answer: "sum"
    hint: "add up all squared differences"
solution: |
  import numpy as np

  def template_match(image, template):
      h, w = image.shape
      th, tw = template.shape
      results = []
      for i in range(h - th + 1):
          for j in range(w - tw + 1):
              region = image[i:i+th, j:j+tw]
              ssd = np.sum((region - template) ** 2)
              results.append((i, j, ssd))
      return min(results, key=lambda x: x[2])

  img = np.eye(4) * 255
  tmpl = np.eye(2) * 255
  pos = template_match(img, tmpl)
  print(f"Match at ({pos[0]}, {pos[1]}), SSD={pos[2]:.0f}")
hints:
  - "np.sum adds all elements of the squared difference array."
  - "The loop range h - th + 1 ensures the template fits inside the image."
concept_tags:
  - template-matching
  - feature-descriptors
