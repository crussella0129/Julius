type: trace
id: "06-unsupervised-trace-01"
prompt: "Trace through this K-means step simulation and predict the output."
code: |
  import math

  points = [(1, 1), (2, 1), (1, 2), (8, 8), (9, 8), (8, 9)]
  centroids = [(1, 1), (8, 8)]

  def dist(a, b):
      return math.sqrt((a[0]-b[0])**2 + (a[1]-b[1])**2)

  # Assignment step
  labels = []
  for p in points:
      d0 = dist(p, centroids[0])
      d1 = dist(p, centroids[1])
      labels.append(0 if d0 <= d1 else 1)

  print(f"Labels: {labels}")

  # Update step
  for c in range(2):
      cluster_pts = [p for p, l in zip(points, labels) if l == c]
      new_x = sum(p[0] for p in cluster_pts) / len(cluster_pts)
      new_y = sum(p[1] for p in cluster_pts) / len(cluster_pts)
      print(f"Centroid {c}: ({new_x:.1f}, {new_y:.1f})")
steps:
  - line: 3
    variables: {"points": "[(1,1),(2,1),(1,2),(8,8),(9,8),(8,9)]", "centroids": "[(1,1),(8,8)]"}
    output: ""
    explanation: "Define 6 points and 2 initial centroids."
  - line: 10
    variables: {}
    output: ""
    explanation: "Assign each point to nearest centroid."
  - line: 11
    variables: {}
    output: ""
    explanation: "Point (1,1): d0=0, d1=9.9 -> label 0. (2,1): d0=1, d1=9.2 -> 0. (1,2): d0=1, d1=9.2 -> 0. (8,8): d0=9.9, d1=0 -> 1. (9,8): d0=9.2, d1=1 -> 1. (8,9): d0=9.2, d1=1 -> 1."
  - line: 15
    variables: {"labels": "[0, 0, 0, 1, 1, 1]"}
    output: "Labels: [0, 0, 0, 1, 1, 1]"
    explanation: "First 3 points assigned to cluster 0, last 3 to cluster 1."
  - line: 18
    variables: {"c": 0}
    output: ""
    explanation: "Cluster 0 points: (1,1), (2,1), (1,2). Mean x=(1+2+1)/3=1.333, y=(1+1+2)/3=1.333."
  - line: 21
    variables: {}
    output: "Centroid 0: (1.3, 1.3)"
    explanation: "New centroid for cluster 0."
  - line: 18
    variables: {"c": 1}
    output: ""
    explanation: "Cluster 1 points: (8,8), (9,8), (8,9). Mean x=(8+9+8)/3=8.333, y=(8+8+9)/3=8.333."
  - line: 21
    variables: {}
    output: "Centroid 1: (8.3, 8.3)"
    explanation: "New centroid for cluster 1."
expected_output: |
  Labels: [0, 0, 0, 1, 1, 1]
  Centroid 0: (1.3, 1.3)
  Centroid 1: (8.3, 8.3)
hints:
  - "Points close to (1,1) go to cluster 0; points close to (8,8) go to cluster 1."
  - "New centroids are the mean of all points in each cluster."
concept_tags:
  - k-means
  - clustering
