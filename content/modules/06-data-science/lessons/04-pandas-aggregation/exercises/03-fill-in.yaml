type: fill-in
id: "04-pandas-aggregation-fill-in-01"
prompt: "Fill in the blanks to merge two DataFrames and group the result."
template: |
  import pandas as pd

  orders = pd.DataFrame({
      \"product_id\": [1, 2, 1, 3],
      \"quantity\": [5, 3, 2, 7],
  })

  products = pd.DataFrame({
      \"product_id\": [1, 2, 3],
      \"name\": [\"Widget\", \"Gadget\", \"Doohickey\"],
  })

  merged = orders.____(products, ____=\"product_id\")
  totals = merged.groupby(\"name\")[\"quantity\"].____()
  print(totals)
blanks:
  - position: 0
    answer: "merge"
    hint: "method to join two DataFrames"
  - position: 1
    answer: "on"
    hint: "parameter specifying the join column"
  - position: 2
    answer: "sum"
    hint: "aggregation function for totals"
solution: |
  import pandas as pd

  orders = pd.DataFrame({
      "product_id": [1, 2, 1, 3],
      "quantity": [5, 3, 2, 7],
  })

  products = pd.DataFrame({
      "product_id": [1, 2, 3],
      "name": ["Widget", "Gadget", "Doohickey"],
  })

  merged = orders.merge(products, on="product_id")
  totals = merged.groupby("name")["quantity"].sum()
  print(totals)
hints:
  - "merge() joins DataFrames on a shared column."
  - "After merging, group by product name and sum quantities."
concept_tags:
  - merge-join
  - groupby
